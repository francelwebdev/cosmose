<div class="container-profile-page d-flex">
  <div class="profile-page-left d-flex flex-column align-items-center col-3">
  <% if @user.photo.attached? %>
        <%= cl_image_tag(@user.photo.key, class: "avatar-large img-fluid" , alt: "avatar") %>
      <% else %>
        <%= image_tag 'https://via.placeholder.com/250', class: "img-fluid" %>
      <% end %>
      <div class="users-infos d-flex flex-column align-items-center mt-2">
    <h4 class="profile-page-username mt-4"><i class="fas fa-user-circle"></i> <%= @user.username.capitalize %></h4>
    <p class="mt-2"><i class="fas fa-map-marker-alt"></i> <%= @user.address %></p>
    <p>< bio ><%= @user.bio %></p>
    </div>
    <div class="user-skills text-center pb-4"><br/>
      <% @user.competences.each do |competence| %>
      <span class="skill"><%= competence %></span>
      <% end %>
    <%= link_to "Message", init_message_user_path(@user), class: "btn btn-primary" %>
  </div>
  <div class="profile-page-right d-flex flex-column align-items-center">
    <div class="buttons-profile d-flex justify-content-around">
      <a class="btn-profile-portfolio btn-profile-active">
      PORTFOLIO
      </a>
      <a class="btn-profile-projects btn-profile-inactive">
      PROJETS
      </a>
    </div>
<div class="content-profile">
      <div class="user-portfolio d-flex">
        <div class="row">
          <div class="blocks">
            <% @blocks.each do |block| %>
            <%= render 'shared/block_display', block: block %>
            <hr />
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="user-projects hidden">
      <div class="content-profile-projects">
        <div class="cards-projects-profile">
          <% @user.projects.each do |project| %>
          <%= link_to project_path(project) do %>
          <div class="card">
            <div class="d-flex flex-column justify-content-between">
              <div class="card-images-element-top">
               <% project_images = project.blocks.map{|image|image if !image.content.include?('youtube') && image.upload.image?}%>
          <% if project_images.reject{|project_image| project_image.nil?}.length >= 1 %>
          <%= image_tag project_images.first.upload, class: "card-images" %>
          <% else %>
          <%= image_tag 'https://res.cloudinary.com/devlnkl7u/image/upload/v1592338203/cosmose-fond-darkred_fw7cod.png', class: "card-images" %>
          <% end %>
              </div>
              <div class="card-images-elements-bottom d-flex justify-content-between">
                <%= render 'shared/icons', categories: project.categories  %>
                <% if project.user.photo.attached? %>
                  <%= cl_image_tag(project.user.photo.key, class: "avatar", alt: "avatar") %>
                <% else %>
                  <%= image_tag 'https://via.placeholder.com/50', class: "avatar"  %>
                <% end %>
              </div>
            </div>
            <div class="card-content">
              <h4 class="card-title"><%= project.title %></h4>
              <p><%= project.description %></p>
              <p class="card-localisation"><%= project.address %></p>
            </div>
          </div>
          <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

